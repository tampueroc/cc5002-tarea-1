<!DOCTYPE html>
<html>

<head>
    <title>Form Validation Example</title>
    <script>
        function validateForm() {
            let street = document.getElementById("street").value;
            let type = document.getElementById("type").value;
            fetch('data.json')
                .then(response => response.json())
                .then(data => {
                    let regionSelect = document.getElementById('region');
                    let comunaSelect = document.getElementById('comuna');

                    // Populate region dropdown
                    data.regions.forEach(region => {
                        let option = document.createElement('option');
                        option.value = region.name;
                        option.text = region.name;
                        regionSelect.appendChild(option);
                    });

                    // Populate comuna dropdown based on selected region
                    regionSelect.addEventListener('change', () => {
                        let selectedRegion = regionSelect.value;
                        comunaSelect.innerHTML = '';

                        data.regions.forEach(region => {
                            if (region.name === selectedRegion) {
                                region.comunas.forEach(comuna => {
                                    let option = document.createElement('option');
                                    option.value = comuna;
                                    option.text = comuna;
                                    comunaSelect.appendChild(option);
                                });
                            }
                        });
                    });
                })
                .catch(error => console.error(error));
            if (region == "") {
                alert("Please select a region.");
                return false;
            }

            if (comuna == "") {
                alert("Please select a comuna.");
                return false;
            }

            if (street == "") {
                alert("Please enter your street name.");
                return false;
            }

            if (street.length > 80) {
                alert("Street name must be less than 80 characters.");
                return false;
            }

            if (type == "") {
                alert("Please select a type.");
                return false;
            }

            return true;
        }
    </script>
</head>

<body>
    <form onsubmit="return validateForm()">
        <label for="region">Region:</label>
        <select id="region" name="region" required>
            <option value="">--Select Region--</option>
        </select>

        <label for="comuna">Comuna:</label>
        <select id="comuna" name="comuna" required>
            <option value="">--Select Comuna--</option>
        </select>

        <label for="street">Street:</label>
        <input type="text" id="street" name="street" maxlength="80" required>

        <label for="type">Type:</label>
        <select id="type" name="type" required>
            <option value="">--Select Type--</option>
            <option value="fruta">Fruta</option>
            <option value="verdura">Verdura</option>
            <option value="otro">Otro</option>
        </select>

        <input type="submit" value="Submit">
    </form>
</body>

</html>